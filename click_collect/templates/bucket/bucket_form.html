{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% load humanize %}

{% block content %}
<h2>Review Bucket</h2>

<form method="post">
{% csrf_token %}

    <table class="table">
        <tr>
            <th>Market</th>
            <th>Product</th>
            <th>Price</th>
            <th>Quantity</th>
            <th class="col_prices">Price</th>
        </tr>
        {% for market_pk,item in request.session.cart.items %}
            {% for bucket_item in item %}
            <tr class="product_row">
                <td>{{bucket_item.market_name}}</td>
                <td>{{bucket_item.name}}</td>
                <td class="price euro_price">{{bucket_item.price}}</td>
                <td >{{bucket_item.quantity}}</td>
                <th class="total_price euro_price">{{bucket_item.total_price|floatformat:2}}</th>
            </tr>
            {% endfor %}
        {% endfor %}
        <tr>
            <th colspan="4" class='text-right'>Total Price</th>
            <th id="total" class="euro_price">{{total_price|floatformat:2}}</th>
        </tr>
    </table>
    <h3>Proceed to Checkout</h3>
    {{form|crispy}}
    <div class="float-right">
    <button type="submit" class="btn btn-primary">Confirm</button>
    </div>
</form>
{% endblock%}
